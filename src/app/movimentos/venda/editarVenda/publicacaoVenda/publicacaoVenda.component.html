<div class="row">
  <div style="margin-right: 15px;" class="pull-right">
    <a (click)="abrirTemplatePublicacao()" class="btn btn-success">
      <i class="fa fa-plus-circle"></i>&nbsp; Nova Publicação
    </a>
  </div>
</div>
<div *ngIf="vendaPublicacoes && vendaPublicacoes.length">
  <div *ngFor="let vp of vendaPublicacoes" class="box box-default  box-solid" style="margin-top: 15px;">
    <div class="box-header with-border">
      <div class="user-block">
        <img style="border: 1px solid #C0C0C0" class="img-circle" src="{{urlUsuarioFotoPerfil(vp.publicacoes.usuario.id, vp.publicacoes.usuario.nomeArquivoFotoPerfil)}}" 
        onerror="this.onerror=null;this.src='./../assets/img/user-default.png';" alt="img">
        <span class="username"><a href="#">{{vp.publicacoes.usuario.nomeCompleto}}</a></span>
        <span class="description">
          Publicado - {{vp.publicacoes.dataHora | date:'dd/MM/yyyy HH:mm'}} |
          Última Edição - {{vp.publicacoes.dataHoraAlteracao | date:'dd/MM/yyyy HH:mm'}}</span>
      </div>
      <div class="box-tools">
        <button type="button" class="btn btn-box-tool" data-toggle="tooltip" title="Mark as read">
          <i class="fa fa-circle-o"></i></button>
        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
        </button>
        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
      </div>
    </div>
    <div class="box-body">
      <p>{{vp.publicacoes.texto}}</p>

      <br />

      <span class="pull-right text-muted">{{vp.publicacoes.publicacaoComentarios.length}} comentários.</span>
    </div>

    <div style="border: 1px solid #C0C0C0" *ngFor="let comentario of vp.publicacoes.publicacaoComentarios" class="box-footer box-comments">
      <div class="box-comment">
        <img style="border: 1px solid #C0C0C0" class="img-circle img-sm" src="{{urlUsuarioFotoPerfil(comentario.usuario.id, comentario.usuario.nomeArquivoFotoPerfil)}}" 
        onerror="this.onerror=null;this.src='./../assets/img/user-default.png';" alt="img">

        <div style="margin-left: 60px;" class="comment-text">
          <span class="username">
            {{comentario.usuario.nomeCompleto}}
            <span class="text-muted pull-right">
              {{comentario.dataHora | date:'dd/MM/yyyy HH:mm'}}</span>
          </span>
          <p>{{comentario.texto}}</p>
        </div>
      </div>

    </div>
    <div class="box-footer">
      <form action="#" method="post">
        <img style="border: 1px solid #C0C0C0" class="img-responsive img-circle img-sm" src="{{getUrlUsuarioLogadoFotoPerfil()}}" 
        onerror="this.onerror=null;this.src='./../assets/img/user-default.png';" alt="img">
        
        <div class="img-push">
          <input type="text" minlength="1" maxlength="255" class="form-control input-sm" [(ngModel)]="vp.publicacoes.textoComentario" name="comentario"
            (keyup.enter)="cadastrarComentario(vp.publicacoes)"
            placeholder="Aperte Enter para publicar o comentário...">
        </div>
      </form>
    </div>
  </div>
</div>

<app-publicacao-template [vendaId]="vendaId" *ngIf="this.getTemplatePublicacao() == true"></app-publicacao-template>